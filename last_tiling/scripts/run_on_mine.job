#!/bin/bash
#$ -S /bin/bash
#$ -N Convert
#$ -cwd
#$ -pe smp 12
#$ -e ./logfiles/convert.log
#$ -o ./logfiles/convert.out
#$ -V 
ROOT=/grid/ban-m/arabidopsis_thaliana/sequel/assemble/mine
LASTTAB=${ROOT}/last_db/initial.tab
READ=${ROOT}/filtered_read.fasta
CONTIGS=${ROOT}/initial_asm/scaffolds.fasta
SELF_LASTTAB=${ROOT}/last_db/self.tab
cargo run --release --bin annotate_dotplot -- ${CONTIGS} ${SELF_LASTTAB} > ./data/mine_repeats.json
cargo run --release --bin encode -- ${LASTTAB} ${CONTIGS} ${READ} ./data/mine_contig.json ./data/mine_reads.json \
      2> ./logfiles/test.log  > ./logfiles/test.out
cargo run --release --bin convert_to_d3_data -- ./data/mine_contig.json ./data/mine_reads.json > ./data/mine_d3.json

